<h2>Creating a fat Jar</h2>

<div class="alert alert-warning">
    <strong>Warning</strong>: Since Java 9, applications should be modular, and distributed
    with tools like <a href="index.html#modular">jlink</a>. However, if you still need to have a 
    non modular application and you want to distribute a single jar, you can do a fat jar.
</div>
<p>
    You can create a runnable fat jar for your JavaFX 11 project on
    <a href="#Maven">Maven</a>, <a href="#Gradle">Gradle</a> or even 
    <a href="#command-line">command line</a>.
</p>

<p>
    As explained <a href="http://mail.openjdk.java.net/pipermail/openjfx-dev/2018-June/021977.html">here</a>,
    in order to create a runnable jar with all the required JavaFX dependencies, 
    you will need to use a launcher class that doesn't extend from <kbd>Application</kbd>.
</p>

<a name="Maven"></a><h3>Maven</h3>

<p>
    If you develop your JavaFX applications using Maven, you don't have to download
    the JavaFX SDK. Just specify the modules and the versions you want in the <kbd>pom.xml</kbd> file,
    and the build system will download the required modules, including the native libraries 
    for your platform.
</p>
<p>
    A simple Maven example can be found in this  
    <a href="https://github.com/openjfx/samples/tree/master/CommandLine/Non-modular/Maven" target="_blank">project</a>.
    The <a href="https://github.com/openjfx/samples/blob/master/CommandLine/Non-modular/Maven/hellofx/pom.xml" target="_blank">pom.xml</a> 
    file shows how to create a runnable fat jar for this <kbd>hellofx</kbd> project with the Maven shade plugin.
</p>

<p>
    Run the plugin to create the fat jar:
</p>

<pre><code>
mvn compile package
</code></pre>

<p>
    Run the application using:
</p>

<ul class="nav nav-tabs">
    <li class="nav-item">
        <a class="nav-link active" href="#nix-maven" data-toggle="tab">Linux/Mac</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#win-maven" data-toggle="tab">Windows</a>
    </li>
</ul>
<div class="tab-content">
    <div class="tab-pane active" id="nix-maven">
<pre class="no-border-radius"><code>
java -jar shade/hellofx.jar
</code></pre>
    </div>
    <div class="tab-pane" id="win-maven">
<pre><code>
java -jar shade\hellofx.jar
</code></pre>
    </div>
</div>

<h4>Cross-platform jar</h4>

<p>
    You can create a cross-platform fat jar by adding the dependencies from the 
    three platforms that require native libraries to your pom file, in this sample 
    only the ones from <kbd>javafx.graphics</kbd>:
</p>

<textarea rows="22" cols="80" style="border:none;" readonly>
    <dependencies>
        ...
        <dependency>
            <groupId>org.openjfx</groupId>
            <artifactId>javafx-graphics</artifactId>
            <version>11</version>
            <classifier>win</classifier>
        </dependency>
        <dependency>
            <groupId>org.openjfx</groupId>
            <artifactId>javafx-graphics</artifactId>
            <version>11</version>
            <classifier>linux</classifier>
        </dependency>
        <dependency>
            <groupId>org.openjfx</groupId>
            <artifactId>javafx-graphics</artifactId>
            <version>11</version>
            <classifier>mac</classifier>
        </dependency>
    </dependencies>
</textarea>

<a id="Gradle"></a><h3>Gradle</h3>

<p>
    If you develop your JavaFX applications using Gradle, you don't have to download
    the JavaFX SDK. Just specify the modules and the versions you want in the <kbd>build.gradle</kbd> file,
    and the build system will download the required modules, 
    including the native libraries for your platform. However, for Gradle we need to 
    find and specify the platform/OS as classifier.
</p>

<p>
    A simple Gradle example can be found in this  
    <a href="https://github.com/openjfx/samples/tree/master/CommandLine/Non-modular/Gradle" target="_blank">project</a>.
    In order to create a runnable fat jar for this project with Gradle,
    modify the <kbd>jar</kbd> task in the <a href="https://github.com/openjfx/samples/blob/master/CommandLine/Non-modular/Gradle/hellofx/build.gradle" target="_blank">build</a> 
    file to include the launcher class:
</p>

<pre><code>
mainClassName = 'hellofx.Launcher'
jar {
    manifest {
        attributes 'Main-Class': 'hellofx.Launcher'
    }
    from {
        configurations.compile.collect { it.isDirectory() ? it : zipTree(it) }
    }
}
</code></pre>

<p>
    Now run the task to create the fat jar and run it:
</p>

<ul class="nav nav-tabs">
    <li class="nav-item">
        <a class="nav-link active" href="#nix-gradle" data-toggle="tab">Linux/Mac</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#win-gradle" data-toggle="tab">Windows</a>
    </li>
</ul>
<div class="tab-content">
    <div class="tab-pane active" id="nix-gradle">
<pre class="no-border-radius"><code>
./gradlew jar

java -jar build/libs/hellofx.jar
</code></pre>
    </div>
    <div class="tab-pane" id="win-gradle">
<pre><code>
gradlew.bat jar

java -jar build\libs\hellofx.jar
</code></pre>
    </div>
</div>

<h4>Cross-platform jar</h4>

<p>
    You can create a cross-platform fat jar by adding the dependencies from the 
    three platforms that require native libraries to the build file, in this sample 
    only the ones from <kbd>javafx.graphics</kbd>:
</p>

<pre><code>
compile "org.openjfx:javafx-graphics:11:win"
compile "org.openjfx:javafx-graphics:11:linux"
compile "org.openjfx:javafx-graphics:11:mac"
</code></pre>

<a name="command-line"></a><h3>Command Line</h3>

<p>
    Finally, you can also create a runnable fat jar for your JavaFX 11 project on
    command line.
</p>

<div class="alert alert-warning">
    <strong>Warning</strong>: This is a discouraged tedious error-prone manual process 
    that should be avoided by using the <a href="#Maven">Maven</a>'s shade plugin or 
    the <a href="#Gradle">Gradle</a>'s jar task, in case <a href="index.html#modular">jlink</a>
    is not applicable.
</div>

<p>
    An example can be found in this  
    <a href="https://github.com/openjfx/samples/tree/master/CommandLine/Non-modular/CLI" target="_blank">project</a>.
    
    Download the appropriate
    <a target="_blank" href="https://gluonhq.com/products/javafx/">JavaFX SDK</a>
    for your operating system and unzip it to a desired location.
</p>

<p>
    Add an environment variable pointing to the lib directory of the runtime:
</p>

<ul class="nav nav-tabs">
    <li class="nav-item">
        <a class="nav-link active" href="#nix-fxpath" data-toggle="tab">Linux/Mac</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#win-fxpath" data-toggle="tab">Windows</a>
    </li>
</ul>

<div class="tab-content">
    <div class="tab-pane active" id="nix-fxpath">
<pre class="no-border-radius"><code>
export PATH_TO_FX=/path/to/javafx-sdk-11/lib
</code></pre>
    </div>
    <div class="tab-pane" id="win-fxpath">
<pre><code>
set PATH_TO_FX="path\to\javafx-sdk-11\lib"
</code></pre>
    </div>
</div>

<p>
    Compile the project:
</p>

<ul class="nav nav-tabs">
    <li class="nav-item">
        <a class="nav-link active" href="#nix-javacout" data-toggle="tab">Linux/Mac</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#win-javacout" data-toggle="tab">Windows</a>
    </li>
</ul>

<div class="tab-content">
    <div class="tab-pane active" id="nix-javacout">
<pre class="no-border-radius"><code>
javac --module-path $PATH_TO_FX --add-modules=javafx.controls -d out $(find src/main/java -name "*.java")
</code></pre>
    </div>
    <div class="tab-pane" id="win-javacout">
<pre><code>
dir /s /b src\main\java\*.java > sources.txt & javac --module-path %PATH_TO_FX% --add-modules=javafx.controls -d out @sources.txt & del sources.txt
</code></pre>
    </div>
</div>

<p>
    And create the fat jar, adding the JavaFX required jars and the platform-specific native libraries. For 
    the <kbd>hellofx</kbd> project:
</p>

<ul class="nav nav-tabs">
    <li class="nav-item">
        <a class="nav-link active" href="#nix-jar" data-toggle="tab">Linux/Mac</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#win-jar" data-toggle="tab">Windows</a>
    </li>
</ul>

<div class="tab-content">
    <div class="tab-pane active" id="nix-jar">
<pre class="no-border-radius"><code>
find $PATH_TO_FX/{javafx.base.jar,javafx.graphics.jar,javafx.controls.jar} -exec unzip -nq {} -d out \;

#uncomment for Linux:
#cp $PATH_TO_FX/{libprism*.so,libjavafx*.so,libglass*.so,libdecora_sse.so} out

#uncomment for Mac:
#cp $PATH_TO_FX/{libprism*.dylib,libjavafx*.dylib,libglass.dylib,libdecora_sse.dylib} out

rm out/META-INF/MANIFEST.MF out/module-info.class
mkdir libs
jar --create --file=libs/hellofx.jar --main-class=hellofx.Launcher -C out .
</code></pre>
    </div>
    <div class="tab-pane" id="win-jar">
<pre><code>
cd out & jar xf "%PATH_TO_FX%\javafx.base.jar" & jar xf "%PATH_TO_FX%\javafx.graphics.jar" & jar xf "%PATH_TO_FX%\javafx.controls.jar" & cd ..
copy "%PATH_TO_FX%\..\bin\prism*.dll" out & copy "%PATH_TO_FX%\..\bin\javafx*.dll" out & copy "%PATH_TO_FX%\..\bin\glass.dll" out && copy "%PATH_TO_FX%\..\bin\decora_sse.dll" out
del out\META-INF\MANIFEST.MF & del out\module-info.class
mkdir libs
jar --create --file=libs/hellofx.jar --main-class=hellofx.Launcher -C out .
</code></pre>
    </div>
</div>

<p>
    And after the jar is built, you can run it:
</p>

<ul class="nav nav-tabs">
    <li class="nav-item">
        <a class="nav-link active" href="#nix-jarrun" data-toggle="tab">Linux/Mac</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#win-jarrun" data-toggle="tab">Windows</a>
    </li>
</ul>
<div class="tab-content">
    <div class="tab-pane active" id="nix-jarrun">
<pre class="no-border-radius"><code>
java -jar libs/hellofx.jar
</code></pre>
    </div>
    <div class="tab-pane" id="win-jarrun">
<pre><code>
java -jar libs\hellofx.jar
</code></pre>
    </div>
</div>

<div class="alert alert-warning">
    <strong>Note: </strong>
    This JRE is platform-specific. However it can be easily a multi-platform jar if the
    different native libraries from each platform were included. This requires downloading the JavaFX SDKs
    for all the platforms, extracting all the necessary jars (for instance, <kbd>javafx.graphics</kbd> is 
    different for each platform), and copying all the native libraries as shown above. As it was mentioned 
    above, this process shouldn't be done manually.
</div>
